# future-letter 详细设计文档
## 1 概述
version: 1.0.0

由于这是一个小项目，第一版会把所有的功能写到future-letter模块中，后续视规模进行拆分。

业务流程图: 

写信流程：登录 -> 填写信件信息 -> 发送（写数据库）

发信流程：从数据库中定时找出到期信件，发送至收件人信箱

## 2 整体架构
### 2.1 写信
考虑到信件的内容很大，不能直接写入数据库。

会先将信件内容写入第三方存储平台，只把url写会数据库。

#### 2.1.1 第三方存储平台调研

| 存储平台 | 服务成本 | 开发成本 | 运维成本 |
|:---|:---|:---|:---|
| 七牛 | <10G 免费 | 低，有java sdk | 低 |


### 2.2 发信
业务流程：定时任务，找到到期邮件，发送。

II期可以考虑引入消息队列，加快发送的速度，扩展的方案如下。

1. 定时任务（生产者）找到待发送的邮件，写消息队列，更新数据库中的发送状态位。
1. 发信任务（消费者）监听消息队列，从消息队列中读出信件，投递至收件人信箱中。
